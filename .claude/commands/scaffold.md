# 阶段2: 上下文提取

读取 `docs/PRD.md`，按 `.claude/textum/GLOBAL-CONTEXT-template-v2.md` 模板生成 `docs/GLOBAL-CONTEXT.md`。

## 前置条件（必满足）

- `docs/PRD.md` 只读（禁止修改）
- `docs/PRD.md` 已包含关键规格：模块 `M-xx`、业务规则（编号用 `BR-###`：三位数字，001 起递增且唯一）、枚举/状态机、数据模型逐表字段、接口清单与关键接口详情
- 本阶段只做“抽取与归纳”，不得引入 PRD 中不存在的新规则/新字段/新接口

## 抽取范围（建议顺序）

1. 技术栈（后端/前端/数据库/部署与关键依赖）
2. 项目结构（目录与职责；可同时记录项目验证命令，如 test/lint/build）
3. 枚举/状态机（统一集中，便于 Story 引用）
4. 业务规则：按 `BR-###` 编号整理；“涉及Story”列先填 `TBD` 或留空
5. 权限矩阵（统一记号与资源范围规则）
6. 数据模型概览（表关系图 + 核心表摘要）
7. 命名规范（表/字段/API/组件）
8. API 规范（Base URL、认证方式、权限校验、分页/排序/筛选、响应格式、错误码）
9. Story 依赖图：先填 `TBD` 或留空

## 低噪音读取（必须遵守）

- 不要通读整份 PRD；只定位并读取生成 GC 所需的章节
- 默认只需要精读：`5.1`（模块清单）、`4`（权限矩阵）、`6`（规则表）、`7`（枚举/状态机）、`9.1/9.2`（API通用约定与接口清单）、`10`（非功能底线）
- 数据模型在 GC 只做“概览”：优先用 PRD `8.1/8.3`，避免把 `8.2` 的逐表字段大段复制进 GC

## 输出要求

- 输出文件: `docs/GLOBAL-CONTEXT.md`
- 作为单一真相源：全局约定写这里
- 严格按模板输出所有章节；除第 4 节“涉及Story”和第 9 节依赖图可用 `TBD`/留空，其余无内容写 `N/A`，不要省略章节

## 校验由用户手动触发（必须遵守）

生成 `docs/GLOBAL-CONTEXT.md` 后，请用户在新窗口运行 `/scaffold-check`：

- 若 `FAIL`：让用户把清单复制粘贴回本窗口，你按清单精准修正并更新 `docs/GLOBAL-CONTEXT.md`；重复直到 `PASS`
- `PASS` 后：进入 `/split-plan`

## 开始

请确认 `docs/PRD.md` 已存在。
