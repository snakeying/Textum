# [项目名称] - PRD v2.0

## 1. 项目概述

### 1.1 一句话简介
[1-2 句话描述项目做什么、给谁用、解决什么问题]

### 1.2 目标（Goals）
- [G-01] [目标描述（可验证）]
- [G-02] [...]

### 1.3 非目标（Non-goals）
- [NG-01] [明确不做什么，防止范围蔓延]
- [NG-02] [...]

## 2. 范围与假设

### 2.1 交付范围（In Scope）
- [S-01] [...]
- [S-02] [...]

### 2.2 不在范围（Out of Scope）
- [OS-01] [...]
- [OS-02] [...]

### 2.3 关键假设与约束
| ID | 假设/约束 | 影响 |
|----|-----------|------|
| A-01 | [...] | [...] |

## 3. 目标用户与角色

### 3.1 用户角色
| 角色 | 描述 | 典型场景 |
|------|------|----------|
| [Role-01] | [是谁] | [会做什么] |
| [Role-02] | [...] | [...] |

## 4. 权限矩阵（必填）

| 操作 | [Role-01] | [Role-02] | [Role-N] | 说明 |
|------|-----------|-----------|----------|------|
| [Resource]:Create | A/D/O | A/D/O | A/D/O | [...] |
| [Resource]:Read | A/D/O | A/D/O | A/D/O | [...] |
| [Resource]:Update | A/D/O | A/D/O | A/D/O | [...] |
| [Resource]:Delete | A/D/O | A/D/O | A/D/O | [...] |

## 5. 核心功能

### 5.1 功能清单（必填）
| 模块ID | 模块名 | 一句话说明 | 优先级 | 依赖 |
|--------|--------|------------|--------|------|
| M-01 | [模块名] | [说明] | [P0/P1/P2] | [无 / M-xx] |
| M-02 | [...] | [...] | [...] | [...] |

### 5.2 功能规格（按模块填写）

#### 5.2.1 [M-01 模块名]
**功能点（尽量一行一条）**
- [FP-01] [...]
- [FP-02] [...]

**关键场景/验收（必填）**
| 场景ID | 参与者 | 前置条件（Given） | 用户操作（When） | 系统响应（Then） | 失败/边界 | 备注 |
|--------|--------|-------------------|------------------|------------------|----------|------|
| SC-01 | [角色] | [...] | [...] | [...] | [...] | [...] |

**页面/路由（可选）**
| 路由 | 页面/入口说明 |
|------|----------------|
| [/path] | [...] |

#### 5.2.2 [M-02 模块名]
（按 5.2.1 结构重复）

## 6. 业务规则（必填）

| 规则ID | 规则描述 | 适用范围（模块/对象） | 例外/备注 |
|--------|----------|------------------------|----------|
| BR-### | [...] | [M-xx / 表/接口] | [...] |

## 7. 状态与枚举（必填）

### 7.1 枚举值
| 字段（表.字段/上下文） | 可选值 | 默认值 | 说明 |
|------------------------|--------|--------|------|
| `[table].[field]` | `val1`, `val2` | `val1` | [...] |

### 7.2 状态机（流程型实体必填）
**[实体名] 状态流转**
```
[State A] -> [State B] -> [State C]
```

| 当前状态 | 触发事件 | 下一状态 | 权限/条件 | 备注 |
|----------|----------|----------|----------|------|
| [A] | [事件] | [B] | [Role/条件] | [...] |

## 8. 数据模型（必填）

### 8.0 功能点→落点映射（必填）

> 目的：把“功能点”与“可追溯的落点（Durable Artifacts）”闭合，避免后续 Story/执行包无法执行或被迫发明 pack 外的新字段/新文件/新表。
>
> 落点允许多选（逗号分隔），仅允许以下前缀：
> - `DB:TBL-###`：数据库表（如适用）
> - `FILE:<path/glob>`：文件/目录/生成产物（如静态站点内容目录、输出目录等）
> - `CFG:<key>`：配置项/开关/参数（如 CLI config key、站点配置项等）
> - `EXT:<system>`：外部依赖（第三方 API/服务/系统资源）
> - `N/A`：确无任何需要持久化/可追溯的落点（纯计算/纯展示且不落地）

| FP | 落点（可多选） | 说明 |
|----|----------------|------|
| FP-01 | DB:TBL-### | [...] |

### 8.1 表清单（可选）
| 表ID | 表名 | 用途 | 主要字段（摘要） |
|------|------|------|------------------|
| `TBL-###` | `[table]` | [...] | `id`, `...` |

### 8.2 表定义（逐表填写，便于按 `TBL-###` 定位）

#### 8.2.1 `TBL-###` `[table_name]` <!-- PRD#TBL-### -->
**用途（必填，一句话）**: [...]

| 字段 | 类型 | 可空 | 默认值 | 约束/索引 | 说明 |
|------|------|------|--------|----------|------|
| `id` | INTEGER PK | N |  | PK | 主键 |
| `[field]` | [类型] | [Y/N] | [默认] | [UNIQUE/FK/INDEX] | [说明] |

**关键约束（必填；无则写 N/A）**
| ID | 约束 | 说明 |
|----|------|------|
| CON-01 | [...] | [...] |

**关键索引（必填；无则写 N/A）**
| ID | 索引 | 用途 |
|----|------|------|
| IDX-01 | [...] | [...] |

#### 8.2.2 `TBL-###` `[table_name_2]` <!-- PRD#TBL-### -->
（按 8.2.1 结构重复）

### 8.3 表关系
```
[表A] 1──n [表B] n──1 [表C]
```

## 9. 接口设计（必填）

### 9.1 通用约定（必填）
**基础**
- Base URL: `[例如: /api]`
- 认证方式: [JWT/Cookie/Session/...]
- 权限校验: [按第 4 节权限矩阵执行]

**分页/排序/筛选（如有）**
- 分页参数: `page`, `pageSize`（或 `cursor`）
- 排序参数: `sort`, `order`
- 筛选参数: [约定字段与语义]

**响应包装（如有）**
```json
{ "data": {}, "message": "" }
```

**错误码（必填）**
| 状态码 | 业务含义 | 典型触发 |
|--------|----------|----------|
| 400 | [Bad Request] | [参数校验失败] |
| 401 | [Unauthorized] | [未登录/Token无效] |
| 403 | [Forbidden] | [无权限] |
| 404 | [Not Found] | [资源不存在] |
| 409 | [Conflict] | [唯一约束冲突/状态冲突] |

### 9.2 接口清单（必填）
| 接口ID | 名称 | 方法&路径 | 模块 | 权限 | 说明 |
|--------|------|----------|------|------|------|
| `API-###` | [接口名] | `[METHOD] /api/...` | [M-xx] | [Role/Operation] | [...] |

### 9.3 接口详情（逐个填写，便于按 `API-###` 定位）

#### 9.3.1 `API-###` [接口名称] <!-- PRD#API-### -->
- **方法&路径**: `[METHOD] /api/...`
- **模块**: [M-xx]
- **权限**: [Operation + 范围规则]

**请求（必填；无则写 N/A）**
| 位置 | 字段 | 类型 | 必填 | 约束 | 说明 |
|------|------|------|------|------|------|
| path/query/body | [field] | [type] | Y/N | [...] | [...] |

**响应（必填；无则写 N/A）**
| 字段 | 类型 | 说明 |
|------|------|------|
| [field] | [type] | [...] |

**失败/边界（必填）**
| 状态码 | 触发条件 | 对用户的提示（如有） |
|--------|----------|------------------------|
| 4XX/5XX | [...] | [...] |

#### 9.3.2 `API-###` [接口名称2] <!-- PRD#API-### -->
（按 9.3.1 结构重复）

## 10. 非功能需求（必填，可写 N/A）
| 类别 | 需求 | 验收口径 |
|------|------|----------|
| 安全 | [例如：敏感字段加密/脱敏] | [如何验证] |
| 审计 | [例如：记录关键管理操作] | [日志字段/保留期] |
| 性能 | [例如：列表接口 < 300ms(P95)] | [压测口径] |
| 可观测 | [例如：关键链路有 traceId] | [日志/指标] |
